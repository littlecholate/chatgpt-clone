為了實現本地 AI (LLM) 與 Microsoft Teams 的整合，我們成功評估並實作了兩種主要的技術方案。目標是讓機器人能接收並回覆 Teams 訊息。以下是這兩種方案的原理、優缺點分析：
方案一：Webhook (推送) 方案
核心原理 (比喻)： 這是「總機」模式。
運作方式：
我們在公司網路上建立一個 Web 伺服器 (Bot 程式)，並為它申請一個公開的 URL (就像一個公開的電話號碼)。
我們在 Microsoft Azure 註冊這個「號碼」(即「Azure Bot 服務」)。
當有使用者傳訊息給 Bot 時，Microsoft Teams (雲端) 會**立即「主動撥打」**我們這個公開號碼，將訊息「推送」給我們。
優點：
即時性： 訊息近乎零延遲，使用者體驗最好。
官方標準： 這是 Microsoft 官方的標準做法，可使用其提供的 SDK (軟體開發工具包)，程式碼較簡單。
缺點 (資源需求)：
網路安全風險： 必須將內部伺服器暴露在公網上 (需要公開 URL)。這需要 IT 網路/資安團隊設定複雜的「反向代理」來確保安全。
高權限需求： 需要「Azure Bot 服務」的管理權限，這必須由雲端管理員協助建立與設定。
方案二：Graph API (輪詢) 方案
核心原理 (比喻)： 這是「定時查勤」模式。
運作方式：
我們的 Bot 程式完全運行在公司內部私網中，不需對外開放。
程式會主動、定期 (例如每 5 秒) 向 Microsoft Teams (雲端) 的 API 發出請求，詢問：「這 5 秒內，有沒有人傳新訊息給我？」
如果 API 回報有新訊息，程式才會將其取回並處理。
優點：
高安全性： 程式 100% 隱藏在公司防火牆後，不需公開 URL。所有連線都是由內部「向外」發起，符合標準資安規範。
架設簡單： 不需要 IT 網路團隊設定反向代理，也不需申請「Azure Bot 服務」。
缺點 (資源需求)：
有延遲： 訊息並非即時。使用者發送訊息後，最長可能需要等待 5 秒 (或我們設定的間隔) 才會被 Bot 讀取。
程式較複雜： 需自行處理認證 (Auth)、輪詢邏輯與防呆機制。
API 權限門檻： 仍需要 Azure AD 管理員一次性「同意」我們的程式讀取聊天訊息 (例如 Chat.ReadWrite.All)。
